<script>

var map = L.map('map',{
    minZoom:11,
    maxZoom:19
}).setView([-7.4,111.4],12);

L.tileLayer(
'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
{ maxZoom:19 }
).addTo(map);

// STYLE MERAH
function style(){
    return {color:"red", weight:6};
}

function onEachFeature(feature, layer){

    var namaJalan = feature.properties["Fungsi Jalan"] || "Ruas Jalan";

    // LABEL TENGAH
    layer.bindTooltip(namaJalan,{
        permanent:true,
        direction:"center",
        className:"label-jalan"
    });

    layer.on("click",function(){

        layer.unbindTooltip();

        var p = feature.properties;

        var isi = `
        <b>Detail Jalan</b><br><br>
        <b>Nama Jalan :</b> ${p["Fungsi Jalan"]}<br>
        <b>Kondisi :</b> ${p["Kondisi Jalan "]}<br>
        <b>Tipe Perkerasan :</b> ${p["Tipe Perkerasan"]}<br>
        <b>Panjang :</b> ${p["Panjang Jln"]} meter
        `;

        document.getElementById("info-content").innerHTML = isi;
        document.getElementById("info-panel").classList.remove("hidden");

        window.activeLayer = layer;
        window.activeTooltipName = namaJalan;

    });
}

// LOAD GEOJSON
fetch("Jalan2.geojson")
.then(res=>res.json())
.then(data=>{

    var layer = L.geoJSON(data,{
        style:style,
        onEachFeature:onEachFeature
    }).addTo(map);

    map.fitBounds(layer.getBounds());
});

document.getElementById("close-info").onclick = function(){

    document.getElementById("info-panel").classList.add("hidden");

    if(window.activeLayer){
        window.activeLayer.bindTooltip(window.activeTooltipName,{
            permanent:true,
            direction:"center",
            className:"label-jalan"
        });
    }
};

</script>
